<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta content='IE=edge' http-equiv='X-UA-Compatible'/>
  <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'/>
  <meta content='true' name='HandheldFriendly'/>
  <meta content='yes' name='apple-mobile-web-app-capable'/>
  <title>AudioQalb গিভওয়ে লাইভ | ৫০টি প্রশ্ন | ১ ঘন্টা</title>
  <!-- Google Fonts & Font Awesome -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; background: radial-gradient(circle at 50% 50%, #0b0e14, #030405); font-family: 'Cairo', 'Inter', sans-serif; color: white; display: flex; align-items: center; justify-content: center; position: relative; }
    .watermark-logo { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 250px; height: auto; opacity: 0.1; pointer-events: none; z-index: 2; }
    .live-container { position: relative; z-index: 10; width: 100%; max-width: 1600px; height: 100%; background: rgba(8, 12, 25, 0.85); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 2px solid rgba(255, 215, 0, 0.35); box-shadow: 0 30px 60px rgba(0,0,0,0.7), 0 0 0 1px rgba(255,215,0,0.2) inset; display: flex; flex-direction: column; padding: 20px 25px; animation: borderGlow 4s infinite alternate; transition: padding 0.3s ease, border-radius 0.3s ease; overflow: hidden; }
    @keyframes borderGlow { 0% { border-color: rgba(255,215,0,0.25); box-shadow: 0 30px 60px rgba(0,0,0,0.7), 0 0 0 1px rgba(255,215,0,0.15) inset; } 100% { border-color: rgba(255,215,0,0.6); box-shadow: 0 40px 80px rgba(255,215,0,0.2), 0 0 0 3px rgba(255,215,0,0.2) inset; } }
    .live-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 12px; border-bottom: 2px dashed rgba(255,215,0,0.4); margin-bottom: 16px; flex-shrink: 0; }
    .logo { display: flex; align-items: center; gap: 12px; }
    .logo-img { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid #ffd700; }
    .logo span { font-size: 32px; font-weight: 900; background: linear-gradient(145deg, #ffe082, #ffb300); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: 1px; }
    .day-badge { background: rgba(0,0,0,0.6); padding: 8px 20px; border-radius: 40px; font-size: 24px; font-weight: 700; color: #ffd700; border: 1px solid #ffd700; box-shadow: 0 0 20px rgba(255,215,0,0.3); backdrop-filter: blur(4px); white-space: nowrap; }
    .live-badge { background: rgba(255,0,0,0.8); padding: 8px 25px; border-radius: 40px; font-size: 24px; font-weight: 700; color: white; border: 1px solid #ffd700; animation: pulse 2s infinite; margin-left: 15px; }
    @keyframes pulse { 0% { opacity: 0.8; } 50% { opacity: 1; background: #ff3333; } 100% { opacity: 0.8; } }
    .question-area { flex: 1 1 auto; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.25); border-radius: 40px; margin: 10px 0; padding: 20px; border: 1px solid rgba(255,215,0,0.2); min-height: 0; }
    .question-text { font-size: 36px; font-weight: 900; line-height: 1.4; text-align: center; color: #fff; text-shadow: 0 4px 20px rgba(0,0,0,0.8); word-break: break-word; animation: fadeSlide 0.8s ease; }
    .question-english { font-size: 24px; font-weight: 500; color: #ffd700; margin-top: 10px; font-family: 'Inter', sans-serif; opacity: 0.9; }
    .options-row { display: grid; grid-template-columns: 1fr; gap: 15px; width: 100%; margin: 15px 0; flex-shrink: 0; }
    @media screen and (min-width: 768px) and (orientation: landscape) { .options-row { grid-template-columns: repeat(3, 1fr); } }
    .option-card { background: linear-gradient(145deg, #16202e, #0c111b); border: 2px solid rgba(255,215,0,0.3); border-radius: 30px; padding: 18px 12px; font-size: 24px; font-weight: 700; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px; box-shadow: 0 10px 0 #00000055, 0 0 30px rgba(0,0,0,0.5); transition: all 0.2s; text-shadow: 0 2px 5px black; }
    .option-bn { display: flex; align-items: center; gap: 12px; }
    .option-bn i { color: #ffd700; font-size: 28px; filter: drop-shadow(0 0 8px gold); }
    .option-en { font-size: 18px; color: #ffd700; font-family: 'Inter', sans-serif; font-weight: 500; }
    .option-correct { background: #1e4a1e !important; border-color: #ffd700 !important; box-shadow: 0 0 60px #2e7d32, 0 10px 0 #0a2e0a !important; }
    .timer-section { display: flex; flex-direction: column; align-items: flex-start; gap: 15px; margin-top: 5px; flex-shrink: 0; }
    @media screen and (min-width: 1024px) and (orientation: landscape) { .timer-section { flex-direction: row; align-items: center; justify-content: space-between; } }
    .circular-timer { display: flex; align-items: center; gap: 20px; width: 100%; justify-content: space-between; }
    .progress-circle { width: 100px; height: 100px; border-radius: 50%; background: conic-gradient(#ffd700 0deg, #2a2a2a 0deg); display: flex; align-items: center; justify-content: center; transition: background 0.1s linear; box-shadow: 0 0 40px rgba(255,215,0,0.4); }
    .inner-circle { width: 82px; height: 82px; border-radius: 50%; background: #0a0f1e; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 3px solid rgba(255,215,0,0.6); }
    .inner-circle span { font-size: 40px; font-weight: 900; color: #ffd700; line-height: 1; }
    .inner-circle small { color: rgba(255,255,255,0.9); font-size: 16px; }
    .shuffle-badge { background: rgba(255,215,0,0.1); padding: 8px 20px; border-radius: 50px; border: 1px dashed gold; font-size: 20px; white-space: nowrap; }
    .progress-text { background: rgba(255,215,0,0.1); padding: 8px 20px; border-radius: 50px; border: 1px dashed gold; font-size: 24px; }
    .progress-text i { color: #ffd700; margin-right: 10px; }
    .controls-wrapper { display: flex; gap: 15px; align-items: center; width: 100%; justify-content: flex-end; flex-wrap: wrap; }
    .audio-control { display: flex; align-items: center; gap: 12px; background: rgba(0,0,0,0.5); padding: 8px 20px; border-radius: 60px; border: 1px solid rgba(255,215,0,0.6); }
    .audio-control button { background: transparent; border: none; color: #ffd700; font-size: 28px; cursor: pointer; transition: 0.2s; }
    .subscribe-btn { background: #ff0000; border: none; color: white; padding: 12px 28px; border-radius: 60px; font-size: 24px; font-weight: 700; cursor: pointer; backdrop-filter: blur(6px); display: flex; gap: 12px; align-items: center; transition: 0.3s; border: 1px solid rgba(255,255,255,0.3); }
    .subscribe-btn:hover { background: #cc0000; transform: scale(1.05); }
    .live-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; color: rgba(255,215,0,0.8); font-size: 20px; flex-shrink: 0; }
    @keyframes fadeSlide { 0% { opacity: 0; transform: translateY(30px); } 100% { opacity: 1; transform: translateY(0); } }
    @media screen and (orientation: landscape) and (max-height: 500px) {
      .live-container { padding: 12px 20px; border-radius: 0; }
      .logo-img { width: 40px; height: 40px; }
      .logo span { font-size: 24px; }
      .day-badge { font-size: 18px; padding: 6px 16px; }
      .question-text { font-size: 26px; }
      .question-english { font-size: 18px; }
      .option-card { font-size: 20px; padding: 10px; }
      .option-en { font-size: 14px; }
      .progress-circle { width: 70px; height: 70px; }
      .inner-circle { width: 58px; height: 58px; }
      .inner-circle span { font-size: 28px; }
      .subscribe-btn { padding: 8px 20px; font-size: 20px; }
      .watermark-logo { width: 150px; }
    }
    @media screen and (min-width: 1024px) and (orientation: landscape) {
      .live-container { width: 95vw; height: 90vh; border-radius: 60px; padding: 30px 50px; }
      .logo-img { width: 70px; height: 70px; }
      .logo span { font-size: 48px; }
      .day-badge { font-size: 32px; padding: 12px 32px; }
      .question-text { font-size: 64px; }
      .question-english { font-size: 32px; }
      .option-card { font-size: 40px; padding: 30px 15px; }
      .option-en { font-size: 24px; }
      .progress-circle { width: 140px; height: 140px; }
      .inner-circle { width: 118px; height: 118px; }
      .inner-circle span { font-size: 58px; }
      .timer-section { flex-direction: row; }
      .subscribe-btn { padding: 18px 40px; font-size: 32px; }
      .watermark-logo { width: 350px; }
    }
    @supports (padding: max(0px)) { .live-container { padding-left: max(20px, env(safe-area-inset-left)); padding-right: max(20px, env(safe-area-inset-right)); padding-bottom: max(16px, env(safe-area-inset-bottom)); } }
    body, html { overflow: hidden; }

    /* ----- গিভওয়ে স্পেসিফিক স্ক্রিন ----- */
    .screen { display: none; flex-direction: column; height: 100%; width: 100%; }
    .screen.active { display: flex; }
    .rules-content, .end-content { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
    .rules-title, .end-title { font-size: 56px; color: #ffd700; margin-bottom: 30px; text-shadow: 0 0 20px rgba(255,215,0,0.5); }
    .rules-list { font-size: 32px; line-height: 2.2; max-width: 1000px; background: rgba(0,0,0,0.7); padding: 30px 50px; border-radius: 60px; border: 2px solid #ffd700; }
    .rules-list i { color: #ffd700; margin-right: 15px; }
    .countdown-timer { font-size: 48px; background: rgba(0,0,0,0.5); padding: 20px 40px; border-radius: 60px; border: 2px solid #ffd700; margin-top: 40px; }
    .end-message { font-size: 36px; max-width: 1000px; line-height: 1.5; background: rgba(0,0,0,0.7); padding: 40px; border-radius: 60px; border: 2px solid #ffd700; }
    .next-countdown { font-size: 48px; margin-top: 40px; padding: 20px 40px; background: rgba(0,0,0,0.5); border-radius: 60px; border: 2px solid #ffd700; }
    .pin-comment { position: fixed; bottom: 20px; left: 20px; right: 20px; background: #cc0000; backdrop-filter: blur(10px); border: 2px solid #ffd700; border-radius: 40px; padding: 10px 20px; text-align: center; font-size: 18px; z-index: 100; color: white; }
    .pin-comment i { color: #ffd700; margin-right: 8px; }
    .pin-comment a { color: #ffd700; text-decoration: underline; font-weight: bold; }
    .pin-comment a:hover { color: white; }

    /* ----- ওভারলে স্টার্ট বাটন ----- */
    .start-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      backdrop-filter: blur(15px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      transition: opacity 1s ease;
    }
    .start-btn {
      background: #ff0000;
      border: 4px solid #ffd700;
      color: white;
      padding: 30px 70px;
      border-radius: 100px;
      font-size: 56px;
      font-weight: 900;
      cursor: pointer;
      box-shadow: 0 0 60px rgba(255,215,0,0.5);
      display: flex;
      gap: 20px;
      align-items: center;
      transition: transform 0.3s;
    }
    .start-btn:hover { transform: scale(1.1); }
    .start-btn i { font-size: 64px; }

    @media (max-width: 768px) {
      .rules-title { font-size: 40px; }
      .rules-list { font-size: 24px; padding: 20px; }
      .countdown-timer { font-size: 32px; }
      .end-title { font-size: 40px; }
      .end-message { font-size: 24px; padding: 20px; }
      .next-countdown { font-size: 28px; }
      .start-btn { font-size: 36px; padding: 20px 40px; }
      .start-btn i { font-size: 40px; }
    }
  </style>
</head>
<body>
  <!-- স্টার্ট ওভারলে -->
  <div id="startOverlay" class="start-overlay">
    <button id="startBtn" class="start-btn">
      <i class="fas fa-play"></i> লাইভ শুরু করুন
    </button>
  </div>

  <img src="https://github.com/RidwanAhmed6/yt-quiz/blob/main/IMG_1067.png?raw=true" alt="AudioQalb Logo" class="watermark-logo">

<div class="live-container">
  <!-- হেডার (সকল স্ক্রিনে কমন) -->
  <div class="live-header">
    <div class="logo">
      <img src="https://github.com/RidwanAhmed6/yt-quiz/blob/main/IMG_1067.png?raw=true" alt="AudioQalb" class="logo-img">
      <span>AudioQalb গিভওয়ে</span>
    </div>
    <div style="display: flex; align-items: center;">
      <div class="day-badge"><i class="fas fa-calendar-alt"></i> আসর <span id="asrDay">১৫</span></div>
      <div class="live-badge"><i class="fas fa-circle"></i> লাইভ</div>
    </div>
  </div>

  <!-- স্ক্রিন ১: নিয়ম (প্রি-শো) -->
  <div id="rulesScreen" class="screen active">
    <div class="rules-content">
      <h1 class="rules-title"><i class="fas fa-gift"></i> গিভওয়ে নিয়ম</h1>
      <div class="rules-list">
        <p><i class="fas fa-check-circle"></i> মোট ৫০টি কুইজ – ১ ঘন্টা লাইভ</p>
        <p><i class="fas fa-check-circle"></i> উত্তর দিতে হবে ফর্মে (নিচে লিংক দেওয়া)</p>
        <p><i class="fas fa-check-circle"></i> সঠিক উত্তর দাতাদের মধ্য থেকে ৩ জন বিজয়ী</p>
        <p><i class="fas fa-check-circle"></i> পুরস্কার: ৫০০ টাকা মূল্যের টিশার্ট বান্ডেল</p>
        <p><i class="fas fa-check-circle"></i> ফর্ম সাবমিটের শেষ সময়: রাত ৯টা (আজকের লাইভ)</p>
        <p><i class="fas fa-check-circle"></i> একবারই ফর্ম সাবমিট করা যাবে</p>
      </div>
      <div class="countdown-timer">
        <i class="fas fa-clock"></i> কুইজ শুরু হবে <span id="preCountdown">০২:০০</span> মিনিটে
      </div>
    </div>
  </div>

  <!-- স্ক্রিন ২: কুইজ চলছে -->
  <div id="quizScreen" class="screen">
    <div class="question-area">
      <div class="question-text" id="question">প্রশ্ন লোড হচ্ছে…</div>
      <div class="question-english" id="questionEn"></div>
    </div>
    <div class="options-row" id="optionsRow">
      <div class="option-card" id="optA"><span class="option-bn"><i class="fas fa-cube"></i> A) ...</span><span class="option-en" id="optAEn"></span></div>
      <div class="option-card" id="optB"><span class="option-bn"><i class="fas fa-cube"></i> B) ...</span><span class="option-en" id="optBEn"></span></div>
      <div class="option-card" id="optC"><span class="option-bn"><i class="fas fa-cube"></i> C) ...</span><span class="option-en" id="optCEn"></span></div>
    </div>
    <div class="timer-section">
      <div class="circular-timer">
        <div class="progress-circle" id="progressCircle">
          <div class="inner-circle">
            <span id="timerNumber">60</span>
            <small>সেকেন্ড</small>
          </div>
        </div>
        <div class="shuffle-badge"><i class="fas fa-shuffle"></i> স্বয়ংক্রিয় শাফল</div>
      </div>
      <div class="progress-text"><i class="fas fa-question-circle"></i> <span id="currentQ">1</span>/50</div>
    </div>
  </div>

  <!-- স্ক্রিন ৩: গিভওয়ে শেষ -->
  <div id="endScreen" class="screen">
    <div class="end-content">
      <h1 class="end-title"><i class="fas fa-trophy"></i> আজকের গিভওয়ে শেষ</h1>
      <div class="end-message">
        <p>আপনার অংশগ্রহণের জন্য ধন্যবাদ!</p>
        <p>সঠিক উত্তর দাতাদের মধ্য থেকে ৩ জন বিজয়ী ঘোষণা করা হবে।</p>
        <p>ফর্ম সাবমিটের সময় শেষ: রাত ৯টা।</p>
        <p>আগামীকাল আবার লাইভে দেখা হবে ইনশাআল্লাহ।</p>
      </div>
      <div class="next-countdown" id="nextCountdown">
        <i class="fas fa-clock"></i> আগামীকাল শুরু হবে: <span>২৩:৫৯:৫৯</span>
      </div>
    </div>
  </div>

  <!-- পিন কমেন্ট (ফর্ম লিংক) -->
  <div class="pin-comment" id="pinComment">
    <i class="fas fa-thumbtack"></i> ফর্ম লিংক: 
    <a href="#" target="_blank" id="formLink">https://forms.gle/your-form-id</a>
  </div>

  <div class="live-footer">
    <span><i class="fas fa-video"></i> YouTube Live 16:9</span>
    <span><i class="fas fa-star"></i> আসর (Day) সীট থেকে স্বয়ংক্রিয়</span>
  </div>
</div>

<!-- অডিও ব্যাকগ্রাউন্ড -->
<audio id="backgroundAudio" loop playsinline>
  <source src="https://github.com/RidwanAhmed6/audioqalb-giveaway/raw/refs/heads/main/copy_59608E65-4060-4B55-AFA9-AFFA060779A0.mp3" type="audio/mpeg">
</audio>

<script>
  // ============================================
  // AudioQalb গিভওয়ে লাইভ – ৫০ প্রশ্ন, ১ ঘন্টা
  // পূর্বের Apps Script URL + স্টার্ট বাটন + সব নির্দেশনা
  // ============================================

  // ---------- কনফিগারেশন ----------
  const API_URL = "https://script.google.com/macros/s/AKfycbzOuyVqqahjf02keFaTgA-7O4lCfNZYnbFTs98VfLy_r-Qd5HwX-pZ5cXRsgyEy1NNWIQ/exec";
  const TOTAL_QUESTIONS = 50;
  const QUIZ_TIME_PER_QUESTION = 60; // সেকেন্ড
  const RULES_DURATION = 120; // ২ মিনিট (স্টার্ট বাটন চাপার পর থেকে)
  const FORM_DEADLINE = { hour: 21, minute: 0 }; // রাত ৯টা
  const LIVE_START_HOUR = 19; // সন্ধ্যা ৭টা (আগামীকালের জন্য)

  // ---------- গ্লোবাল ভেরিয়েবল ----------
  let allQuizData = [];
  let quizData = [];
  let currentIdx = 0;
  let timerInterval = null;
  let timeLeft = QUIZ_TIME_PER_QUESTION;
  let isAnswered = false;
  let correctAns = '';
  let rulesTimer = RULES_DURATION;
  let rulesInterval = null;
  let currentRamadanDay = 15;

  // DOM এলিমেন্ট
  const startOverlay = document.getElementById('startOverlay');
  const startBtn = document.getElementById('startBtn');
  const rulesScreen = document.getElementById('rulesScreen');
  const quizScreen = document.getElementById('quizScreen');
  const endScreen = document.getElementById('endScreen');
  const preCountdownSpan = document.getElementById('preCountdown');
  const questionEl = document.getElementById('question');
  const questionEnEl = document.getElementById('questionEn');
  const optA = document.getElementById('optA');
  const optB = document.getElementById('optB');
  const optC = document.getElementById('optC');
  const optAEn = document.getElementById('optAEn');
  const optBEn = document.getElementById('optBEn');
  const optCEn = document.getElementById('optCEn');
  const timerNumber = document.getElementById('timerNumber');
  const progressCircle = document.getElementById('progressCircle');
  const currentQSpan = document.getElementById('currentQ');
  const nextCountdownSpan = document.querySelector('#nextCountdown span');
  const asrDaySpan = document.getElementById('asrDay');
  const formLink = document.getElementById('formLink');
  const audioEl = document.getElementById('backgroundAudio');
  const audioToggleBtn = document.querySelector('.audio-control button');
  const audioIcon = document.getElementById('audioIcon');

  // ---------- ফর্ম লিংক সেট করুন ----------
  formLink.href = '#'; // আপনার আসল ফর্ম লিংক দিন
  formLink.innerText = 'ফর্ম লিংক (শীঘ্রই আসছে)';

  // ---------- API ফেচ ----------
  async function fetchQuizzes() {
    try {
      const CACHE_BUSTER = '?t=' + new Date().getTime();
      const res = await fetch(API_URL + CACHE_BUSTER);
      if (!res.ok) throw new Error(`HTTP error ${res.status}`);
      allQuizData = await res.json();
      
      if (allQuizData.error) {
        questionEl.innerText = '❌ ' + allQuizData.error;
        return;
      }

      const hasDayColumn = allQuizData.length > 0 && allQuizData[0].hasOwnProperty('day');
      
      if (hasDayColumn) {
        const firstDay = parseInt(allQuizData[0].day);
        if (!isNaN(firstDay) && firstDay >= 1 && firstDay <= 30) currentRamadanDay = firstDay;
        quizData = allQuizData.filter(q => parseInt(q.day) === currentRamadanDay);
        if (quizData.length === 0) quizData = [...allQuizData];
      } else {
        quizData = [...allQuizData];
      }

      if (quizData.length > TOTAL_QUESTIONS) {
        quizData = quizData.slice(0, TOTAL_QUESTIONS);
      }

      asrDaySpan.innerText = currentRamadanDay;

      if (quizData.length) {
        shuffleArray(quizData);
        showQuestion(0);
        // টাইমার এখনো শুরু হবে না, স্টার্ট বাটন চাপার পর শুরু হবে
      } else {
        questionEl.innerText = '❌ কোনো কুইজ ডাটা নেই';
      }
    } catch (e) {
      console.error(e);
      questionEl.innerText = '⚠️ API সংযোগ ব্যর্থ, URL চেক করুন';
    }
  }

  // ---------- শাফল ----------
  function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  // ---------- প্রশ্ন দেখান ----------
  function showQuestion(index) {
    if (!quizData.length) return;
    const q = quizData[index];
    questionEl.innerText = q.question || 'প্রশ্ন নেই';
    questionEnEl.innerText = q.questionEN || '';
    
    const optABn = optA.querySelector('.option-bn');
    const optBBn = optB.querySelector('.option-bn');
    const optCBn = optC.querySelector('.option-bn');
    optABn.innerHTML = `<i class="fas fa-cube"></i> A) ${q.optionA || ''}`;
    optBBn.innerHTML = `<i class="fas fa-cube"></i> B) ${q.optionB || ''}`;
    optCBn.innerHTML = `<i class="fas fa-cube"></i> C) ${q.optionC || ''}`;
    optAEn.innerText = q.optionAEN || '';
    optBEn.innerText = q.optionBEN || '';
    optCEn.innerText = q.optionCEN || '';

    correctAns = (q.correct || 'A').toUpperCase();
    removeHighlights();
    isAnswered = false;
    currentQSpan.innerText = index + 1;
  }

  function removeHighlights() {
    optA.classList.remove('option-correct');
    optB.classList.remove('option-correct');
    optC.classList.remove('option-correct');
  }

  function showCorrectAnswer() {
    if (isAnswered) return;
    isAnswered = true;
    const el = document.getElementById(`opt${correctAns}`);
    if (el) el.classList.add('option-correct');
  }

  // ---------- টাইমার ----------
  function startTimer() {
    if (timerInterval) clearInterval(timerInterval);
    timeLeft = QUIZ_TIME_PER_QUESTION;
    updateTimerUI(timeLeft);
    timerInterval = setInterval(() => {
      timeLeft--;
      updateTimerUI(timeLeft);
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        showCorrectAnswer();
        setTimeout(nextQuestion, 2000);
      }
    }, 1000);
  }

  function updateTimerUI(sec) {
    timerNumber.innerText = sec;
    const angle = (sec / QUIZ_TIME_PER_QUESTION) * 360;
    progressCircle.style.background = `conic-gradient(#ffd700 ${angle}deg, #2a2a2a ${angle}deg)`;
    progressCircle.style.boxShadow = sec <= 5 ? '0 0 60px rgba(255,0,0,0.8)' : '0 0 40px rgba(255,215,0,0.5)';
  }

  function nextQuestion() {
    currentIdx++;
    if (currentIdx >= quizData.length) {
      showEndScreen();
      return;
    }
    showQuestion(currentIdx);
    startTimer();
  }

  // ---------- শেষ স্ক্রিন ----------
  function showEndScreen() {
    quizScreen.classList.remove('active');
    endScreen.classList.add('active');
    startNextCountdown();
  }

  // ---------- আগামীকালের কাউন্টডাউন ----------
  function startNextCountdown() {
    const now = new Date();
    const tomorrow = new Date(now);
    tomorrow.setDate(now.getDate() + 1);
    tomorrow.setHours(LIVE_START_HOUR, 0, 0, 0);

    function updateCountdown() {
      const diff = tomorrow - new Date();
      if (diff <= 0) {
        nextCountdownSpan.innerText = 'শুরু হয়েছে!';
        return;
      }
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      nextCountdownSpan.innerText = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    updateCountdown();
    setInterval(updateCountdown, 1000);
  }

  // ---------- ফর্ম ডেডলাইন চেক ----------
  function checkFormDeadline() {
    const now = new Date();
    const deadline = new Date(now);
    deadline.setHours(FORM_DEADLINE.hour, FORM_DEADLINE.minute, 0, 0);
    if (now > deadline) {
      formLink.style.pointerEvents = 'none';
      formLink.style.opacity = 0.5;
      formLink.innerText = 'ফর্ম বন্ধ (রাত ৯টা পেরিয়েছে)';
    } else {
      const diff = deadline - now;
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      formLink.innerText = `ফর্ম খোলা (আর ${hours}ঘ ${minutes}মি)`;
    }
  }
  checkFormDeadline();
  setInterval(checkFormDeadline, 60000);

  // ---------- অডিও কন্ট্রোল ----------
  if (audioToggleBtn) {
    audioToggleBtn.addEventListener('click', function() {
      if (audioEl.paused) {
        audioEl.play().catch(e => console.log(e));
        if (audioIcon) audioIcon.className = 'fas fa-volume-up';
      } else {
        audioEl.pause();
        if (audioIcon) audioIcon.className = 'fas fa-volume-mute';
      }
    });
  }

  // ---------- স্টার্ট বাটন ইভেন্ট ----------
  startBtn.addEventListener('click', function() {
    // ওভারলে ফেইড আউট
    startOverlay.style.opacity = '0';
    setTimeout(() => {
      startOverlay.style.display = 'none';
    }, 1000);

    // নাশিদ চালু
    audioEl.play().catch(e => console.log('Audio play failed:', e));
    
    // নিয়ম কাউন্টডাউন শুরু
    startRulesTimer();
  });

  // ---------- নিয়ম কাউন্টডাউন ----------
  function startRulesTimer() {
    rulesInterval = setInterval(() => {
      rulesTimer--;
      if (rulesTimer <= 0) {
        clearInterval(rulesInterval);
        // কুইজ স্ক্রিন দেখাও
        rulesScreen.classList.remove('active');
        quizScreen.classList.add('active');
        startTimer(); // টাইমার শুরু
      } else {
        const mins = Math.floor(rulesTimer / 60);
        const secs = rulesTimer % 60;
        preCountdownSpan.innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      }
    }, 1000);
  }

  // ---------- শুরুতে API কল ----------
  fetchQuizzes();

  // পিন কমেন্ট সবসময় visible
</script>
</body>
</html>
